<!doctype html>
<html lang="es"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ticket de salida â€” PEVE</title>
<link rel="stylesheet" href="../assets/style.css">
<script defer src="../assets/app.js"></script>
<script defer src="../assets/api.js"></script>
</head>
<body>

<header class="header">
  <div class="logo">
    <span class="badge">PEVE</span>
    <span class="title">Plataforma ExÃ¡menes de ValidaciÃ³n de Estudios</span>
  </div>
  <div class="row">
    <button class="toggle" data-action="fs-dec">Aâˆ’</button>
    <button class="toggle" data-action="fs-inc">A+</button>
    <button class="toggle" data-action="contrast">ğŸŒ“ Alto contraste</button>
  </div>
</header>

<main>
  <h2>ğŸŸï¸ Ticket de salida</h2>
  <div class="card">
    <label>Hoy aprendÃ­ que...</label>
    <textarea rows="4" placeholder="Escribe aquÃ­"></textarea>
    <label>Una duda que me queda es...</label>
    <textarea rows="3" placeholder="Escribe aquÃ­"></textarea>
    <label>Lo explicarÃ© con un ejemplo de...</label>
    <textarea rows="3" placeholder="Escribe aquÃ­"></textarea>
    <div class="row"><button class="btn" onclick="sendTicket()">Guardar</button></div>
    <small class="notice">Para guardar real, conectar con planilla/API.</small>
  </div>
</main>

<footer class="footer">
  <div>Proyecto ExÃ¡menes Libres â€” Pancho & BelÃ©n</div>
  <div>belen.acpe@gmail.com Â· ğŸ“ +56 9 6266 4960</div>
  <div>ğŸ‘¨â€ğŸ’» Francisco Pinto â€” ğŸ“§ franciscoandresp@gmail.com Â· ğŸ“ +56 9 2002 7992</div>
  <div>Hecho con â¤ï¸ para el Liceo Bicentenario de Excelencia Polivalente San NicolÃ¡s</div>
</footer>

</body></html>

<script>
async function sendTicket(){
  const ta = document.querySelectorAll('textarea');
  const payload = {
    learned: ta[0].value, doubt: ta[1].value, example: ta[2].value,
    course: 'BiologÃ­a 1M', module: 'Ticket salida', timestamp: new Date().toISOString()
  };
  try{
    const u = getSession() || {id:'anon', name:'AnÃ³nimo'};
    payload.userId = u.id; payload.userName = u.name || 'AnÃ³nimo';
    const resp = await PEVE_API.pevePost('ticket_submit', payload);
    alert('Ticket guardado: ' + (resp.status||'ok'));
  }catch(e){ alert('No se pudo guardar el ticket'); }
}
</script>
